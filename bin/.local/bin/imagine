#!/bin/sh

url="$(xsel --clipboard --output)"

notify-send "Imagine" "Fething data for $url"
formats="$(youtube-dl --list-formats -- "$url")" || {
	notify-send "Imagine" "Couldn't find the video"
	exit "1"
}

format="$(printf -- "%s\n" "$formats" | awk -- "(\$0 !~ /\[.+\]/) { print \$1 \" \" \$2 \" \" \$3 }" | column --table | dmenu -p "ï€½ ")" || exit "130"
mpv --ytdl-format="$(printf -- "%s\n" "$format" | cut --delimiter=" " --fields="1" | paste --delimiter="+" --serial)" -- "$url"
